{"ast":null,"code":"var _jsxFileName = \"/home/cluca/Documents/Licenta/WebApplication/frontend/src/scans/pages/UpdateScan.js\";\nimport React, { useEffect, useState, useContext } from 'react';\nimport { useParams, useHistory } from 'react-router-dom';\nimport Input from '../../shared/components/FormElements/Input';\nimport Button from '../../shared/components/FormElements/Button';\nimport LoadingSpinner from '../../shared/components/UIElements/LoadingSpinner';\nimport { AuthContext } from '../../shared/context/auth-context';\nimport ErrorModal from '../../shared/components/UIElements/ErrorModal';\nimport { VALIDATOR_REQUIRE, VALIDATOR_MINLENGTH } from '../../shared/util/validators';\nimport { useForm } from '../../shared/hooks/form-hook';\nimport './ScanForm.css';\nimport Card from '../../shared/components/UIElements/Card';\nimport { useHttpClient } from '../../shared/context/http-hook';\n\nconst UpdateScan = () => {\n  const auth = useContext(AuthContext);\n  const {\n    isLoading,\n    error,\n    sendRequest,\n    clearError\n  } = useHttpClient();\n  const [loadedScan, setLoadedScan] = useState();\n  const scanId = useParams().scanId;\n  const userId = auth.userId;\n  const history = useHistory();\n  const [formState, inputHandler, setFormData] = useForm({\n    title: {\n      value: '',\n      isValid: false\n    },\n    descriere: {\n      value: '',\n      isValid: false\n    },\n    ipdns: {\n      value: '',\n      isValid: false\n    },\n    tipScan: {\n      value: '',\n      isValid: false\n    }\n  }, false);\n  useEffect(() => {\n    const fetchScan = async () => {\n      try {\n        const responseData = await sendRequest(`http://localhost:5000/api/reports/${userId}}/myscans/${scanId}`);\n        setLoadedScan(responseData.scan);\n        setFormData({\n          title: {\n            value: responseData.scan.titlu,\n            isValid: true\n          },\n          descriere: {\n            value: responseData.scan.descriere,\n            isValid: true\n          },\n          ipdns: {\n            value: responseData.scan.addr,\n            isValid: true\n          },\n          tipScan: {\n            value: responseData.scan.tipScan,\n            isValid: true\n          }\n        }, true);\n      } catch (err) {}\n    };\n\n    fetchScan();\n  }, [sendRequest, userId, scanId, setFormData]);\n\n  const scanUpdateSubmitHandler = async event => {\n    event.preventDefault(); //console.log(formState.inputs);\n\n    try {\n      await sendRequest(`http://localhost:5000/api/reports/${userId}}/myscans/${scanId}`, 'PATCH', JSON.stringify({\n        titlu: formState.inputs.title.value,\n        descriere: formState.inputs.descriere.value\n      }), {\n        'Content-Type': 'application/json'\n      });\n      history.push(`/${auth.userId}/myscans`);\n    } catch (err) {}\n  };\n\n  let numeFisier;\n\n  switch (formState.inputs.tipScan.value) {\n    case 'FULL-SCAN':\n      numeFisier = 'raport_full.txt';\n      break;\n\n    case 'WEB-SCAN':\n      numeFisier = 'raport_web.txt';\n      break;\n\n    case 'SERVER-SCAN':\n      numeFisier = 'raport_server.txt';\n      break;\n\n    default:\n      numeFisier = 'raport_full.txt';\n  }\n\n  if (isLoading) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 16\n      }\n    }, /*#__PURE__*/React.createElement(LoadingSpinner, {\n      asOverlay: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 13\n      }\n    }));\n  }\n\n  if (!loadedScan && !error) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 16\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 17\n      }\n    }, \"Nu s-a putut gasi raportul respectiv\")));\n  }\n\n  return /*#__PURE__*/React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(ErrorModal, {\n    error: error,\n    onClear: clearError,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 9\n    }\n  }), !isLoading && loadedScan && /*#__PURE__*/React.createElement(\"form\", {\n    className: \"place-form\",\n    onSubmit: scanUpdateSubmitHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 38\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    className: \"ipdns\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 9\n    }\n  }, \"RAPORT: \", formState.inputs.ipdns.value), /*#__PURE__*/React.createElement(\"label\", {\n    className: \"tipscan\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 9\n    }\n  }, \"TIP SCANARE: \", formState.inputs.tipScan.value), /*#__PURE__*/React.createElement(Input, {\n    id: \"title\",\n    element: \"input\",\n    type: \"text\",\n    label: \"Titlu\",\n    validators: [VALIDATOR_REQUIRE()],\n    errorText: \"Trebuie introdus un titlu valid.\",\n    onInput: inputHandler,\n    value: loadedScan.titlu,\n    valid: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Input, {\n    id: \"descriere\",\n    element: \"textarea\",\n    label: \"Descriere\",\n    validators: [VALIDATOR_MINLENGTH(1)],\n    errorText: \"Trebuie adaugata o descriere scurta.\",\n    onInput: inputHandler,\n    value: loadedScan.descriere,\n    valid: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"label\", {\n    className: \"center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 9\n    }\n  }, \" REZULTATE \"), /*#__PURE__*/React.createElement(\"a\", {\n    href: `/home/cluca/Downloads/${numeFisier}`,\n    download: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 9\n    }\n  }, \"DOWNLOAD REPORT\"), /*#__PURE__*/React.createElement(Button, {\n    type: \"submit\",\n    disabled: !formState.isValid,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 9\n    }\n  }, \"RESCAN\")));\n};\n\nexport default UpdateScan;","map":{"version":3,"sources":["/home/cluca/Documents/Licenta/WebApplication/frontend/src/scans/pages/UpdateScan.js"],"names":["React","useEffect","useState","useContext","useParams","useHistory","Input","Button","LoadingSpinner","AuthContext","ErrorModal","VALIDATOR_REQUIRE","VALIDATOR_MINLENGTH","useForm","Card","useHttpClient","UpdateScan","auth","isLoading","error","sendRequest","clearError","loadedScan","setLoadedScan","scanId","userId","history","formState","inputHandler","setFormData","title","value","isValid","descriere","ipdns","tipScan","fetchScan","responseData","scan","titlu","addr","err","scanUpdateSubmitHandler","event","preventDefault","JSON","stringify","inputs","push","numeFisier"],"mappings":"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","sourcesContent":["import React, { useEffect,useState,useContext } from 'react';\nimport { useParams, useHistory } from 'react-router-dom';\n\nimport Input from '../../shared/components/FormElements/Input';\nimport Button from '../../shared/components/FormElements/Button';\nimport LoadingSpinner from '../../shared/components/UIElements/LoadingSpinner';\nimport { AuthContext } from '../../shared/context/auth-context';\nimport ErrorModal from '../../shared/components/UIElements/ErrorModal';\nimport { VALIDATOR_REQUIRE, VALIDATOR_MINLENGTH } from '../../shared/util/validators';\nimport { useForm } from '../../shared/hooks/form-hook';\nimport './ScanForm.css'\nimport Card from '../../shared/components/UIElements/Card';\nimport { useHttpClient } from '../../shared/context/http-hook';\n\n\n\nconst UpdateScan = () => {\n    const auth = useContext(AuthContext);\n\n    const {isLoading, error, sendRequest, clearError} = useHttpClient();\n    const[loadedScan, setLoadedScan] = useState();\n    const scanId = useParams().scanId;\n    const userId = auth.userId;\n\n    const history = useHistory();\n\n    const [formState, inputHandler, setFormData] = useForm({\n        title: {\n            value: '',\n            isValid: false\n        },\n        descriere: {\n            value: '',\n            isValid: false\n        },\n        ipdns: {\n            value: '',\n            isValid: false\n        },\n        tipScan: {\n            value: '',\n            isValid: false\n        }     \n    },false);\n\n    useEffect(() => {\n        const fetchScan = async () => {\n            try {\n                const responseData = await sendRequest(`http://localhost:5000/api/reports/${userId}}/myscans/${scanId}`);\n                setLoadedScan(responseData.scan);\n                setFormData({\n                    title: {\n                        value: responseData.scan.titlu,\n                        isValid: true\n                    },\n                    descriere: {\n                        value: responseData.scan.descriere,\n                        isValid: true\n                    },\n                    ipdns: {\n                        value: responseData.scan.addr,\n                        isValid: true\n                    },\n                    tipScan: {\n                        value: responseData.scan.tipScan,\n                        isValid: true\n                    }\n                }, true);\n            } catch (err) {}\n        };\n        fetchScan();\n    }, [sendRequest, userId, scanId, setFormData]);\n\n\n    const scanUpdateSubmitHandler = async event => {\n        event.preventDefault();\n        //console.log(formState.inputs);\n        try {\n                await sendRequest(`http://localhost:5000/api/reports/${userId}}/myscans/${scanId}`,'PATCH',JSON.stringify({\n                titlu: formState.inputs.title.value,\n                descriere: formState.inputs.descriere.value,\n            }),\n            {\n                'Content-Type': 'application/json'\n            });\n            history.push(`/${auth.userId}/myscans`);\n        } catch (err) {\n\n        }\n    };\n\n    let numeFisier;\n    switch(formState.inputs.tipScan.value) {\n        case 'FULL-SCAN':\n            numeFisier = 'raport_full.txt';\n          break;\n        case 'WEB-SCAN':\n            numeFisier = 'raport_web.txt';\n          break;\n        case 'SERVER-SCAN':\n            numeFisier = 'raport_server.txt';\n            break;\n        default:\n            numeFisier = 'raport_full.txt';\n      } \n\n    if(isLoading){\n        return <div className=\"center\">\n            <LoadingSpinner asOverlay/>\n            </div>\n    }\n\n    if(!loadedScan && !error ){\n        return <div className=\"center\">\n            <Card>\n                <h2>Nu s-a putut gasi raportul respectiv</h2>\n            </Card>\n            </div>\n    }\n\n\n    return (\n        <React.Fragment>\n        <ErrorModal error={error} onClear={clearError} />\n        {!isLoading && loadedScan && <form className=\"place-form\" onSubmit={scanUpdateSubmitHandler}>\n        <label className=\"ipdns\">RAPORT: {(formState.inputs.ipdns.value)}</label>\n        <label className=\"tipscan\">TIP SCANARE: {(formState.inputs.tipScan.value)}</label>\n        <Input \n            id=\"title\" \n            element=\"input\" \n            type=\"text\" \n            label=\"Titlu\"\n            validators={[VALIDATOR_REQUIRE()]} \n            errorText=\"Trebuie introdus un titlu valid.\" \n            onInput={inputHandler}\n            value={loadedScan.titlu}\n            valid={true}/>\n        <Input \n            id=\"descriere\" \n            element=\"textarea\"\n            label=\"Descriere\"\n            validators={[VALIDATOR_MINLENGTH(1)]} \n            errorText=\"Trebuie adaugata o descriere scurta.\" \n            onInput={inputHandler}\n            value={loadedScan.descriere}\n            valid={true}/>\n        <label className=\"center\"> REZULTATE </label>\n        <a href={`/home/cluca/Downloads/${numeFisier}`} download>DOWNLOAD REPORT</a>\n        <Button type=\"submit\" disabled={!formState.isValid}>RESCAN</Button>\n    </form> }\n    </React.Fragment>\n    );\n};\n\nexport default UpdateScan;"]},"metadata":{},"sourceType":"module"}